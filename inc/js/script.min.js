var fullscreen = false;

function init(){
    var x = document.getElementsByClassName("imgwrap");
    for (var i = 0; i < x.length; i++) {
        x[i].addEventListener("click", function(e){
            openFull(this);
        });
    }
    document.getElementById("fullscreen").addEventListener("click", closeFull);
    document.getElementById("galleryprev").addEventListener("click", prevSlide);
    document.getElementById("gallerynext").addEventListener("click", nextSlide);
}
function openFull(t){
    loadFull(t)
    var full = document.getElementById("fullscreen");
    full.classList.remove("hidden");
    full.focus();
    fullscreen = true;
}
function loadFull(t){
    var full = document.getElementById("fullscreen");
    if(isImg(t)){
       full.querySelector('#content').innerHTML = '<img src="'+t.querySelector('img').getAttribute("data-original").slice(0, -6)+'?r=1000" class="lazy loaded">'; 
    }else if(isVideo(t)){
        full.querySelector('#content').innerHTML = '<video src="'+t.querySelector('img').getAttribute("data-original")+'" >'; 
    }
    full.focus();
}
function closeFull(){ 
    document.getElementById("fullscreen").classList.add("hidden");  
    document.getElementById("fullscreen").querySelector('#content').innerHTML = "";
    fullscreen = false;
}
function prevSlide(e){
    e.stopPropagation();
}
function nextSlide(e){
    e.stopPropagation();
}

//function isimg()	{return (document.getElementsByClassName('imgwrap image full')[0] != undefined);}
//function isvideo()	{return (document.getElementsByClassName('imgwrap video full')[0] != undefined);}
function isImg(e)	{return (e.className.indexOf("image") != -1);}
function isVideo(e)	{return (e.className.indexOf("video") != -1);;}
function stopVideo(e){if(isvideo()){var video = e.getElementsByTagName('video')[0]; video.pause();}}
function toggleVideo(e){if(isVideo(e)){
		var video = e.getElementsByTagName('video')[0];
		if (video.paused == true){	video.play();
		}else{						video.pause();}
}}

document.body.onkeydown=function(e){
  key=e.keyCode || e.charCode|| e.which; //cross browser complications
  if(key===27){	if(fullscreen){ closeFull();	} e.preventDefault();}
  if(key===32){	if(fullscreen){ toggleVideo();} e.preventDefault();}
  if(key===37){	if(fullscreen){ prevSlide();	} e.preventDefault();}
  if(key===39){	if(fullscreen){ nextSlide();	} e.preventDefault();}
}

document.addEventListener("DOMContentLoaded", init);